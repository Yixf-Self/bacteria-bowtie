setwd("/Users/Scott/tophat-bacteria/scripts/R-interactive")
setwd("/Users/Scott/Google Drive/Hurwitz Lab/cuffdiff_reallyall")
gene_counts <- read.table("total.fpkm_tracking",header = T, comment.char = "", strip.white = T, sep = "\t", quote = "", colClasses = "character")
simple_gene_counts<-gene_counts[,c("tracking_id","S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")]
simple_gene_counts$sum<-rowSums(simple_gene_counts[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")])
View(simple_gene_counts)
temp01<-gene_counts[,c("tracking_id")]
temp02<-as.numeric(gene_counts[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")])
temp02<-apply(gene_counts[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")],FUN = as.numeric)
temp02<-apply(gene_counts[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")],MARGIN = c(1,2),FUN = as.numeric)
View(temp02)
?read.table
setwd("/Users/Scott/tophat-bacteria/scripts/R-interactive")
system(command = "./process-reallyall.sh")
setwd("/Users/Scott/Google Drive/Hurwitz Lab/cuffdiff_reallyall")
simple_gene_counts <- read.table("total.fpkm_tracking",header = T, comment.char = "", strip.white = T, sep = "\t", quote = "", colClasses = c("character","numeric","numeric","numeric","numeric"))
rm(gene_counts,temp01,temp02)
simple_gene_counts$sum<-rowSums(simple_gene_counts[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")])
filtered<-simple_gene_counts[simple_gene_counts$sum!=0,]
annotation<-read.table("id_to_product.tab",header = F,sep = '\t',quote = "")
colnames(annotation)<-c("tracking_id","product_name")
gene_annotation<-read.table("id_to_gene.tab",header = F,sep = '\t',quote = "")
colnames(gene_annotation)<-c("tracking_id","gene")
View(filtered)
filtered_annotated<-merge(filtered,annotation,by="tracking_id")
filtered_annotated<-merge(filtered_annotated,gene_annotation,by="tracking_id",all = F)
filtered_annotated<-filtered_annotated[order(filtered_annotated$sum,decreasing = T),]
sum_by_product_name<-rowsum(filtered_annotated[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")],group = filtered_annotated$product_name)
sum_by_gene_name<-rowsum(filtered_annotated[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")],group = filtered_annotated$gene)
write.csv(sum_by_product_name,"sum_by_product_name.csv")
write.csv(sum_by_gene_name,"sum_by_gene_name.csv")
write.csv(filtered_annotated,"diff_exp_for_all_bact.csv")
View(filtered_annotated)
lowercase_annotation<-data.frame((annotation[,1]),tolower(annotation[,2]))
annotation<-lowercase_annotation
colnames(annotation)<-c("tracking_id","product_name")
gene_annotation<-read.table("id_to_gene.tab",header = F,sep = '\t',quote = "")
colnames(gene_annotation)<-c("tracking_id","gene")
filtered_annotated<-merge(filtered,annotation,by="tracking_id")
filtered_annotated<-merge(filtered_annotated,gene_annotation,by="tracking_id",all = F)
filtered_annotated<-filtered_annotated[order(filtered_annotated$sum,decreasing = T),]
sum_by_product_name<-rowsum(filtered_annotated[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")],group = filtered_annotated$product_name)
sum_by_gene_name<-rowsum(filtered_annotated[,c("S1_FPKM","S2_FPKM","S3_FPKM","S4_FPKM")],group = filtered_annotated$gene)
write.csv(sum_by_product_name,"sum_by_product_name.csv")
write.csv(sum_by_gene_name,"sum_by_gene_name.csv")
write.csv(filtered_annotated,"diff_exp_for_all_bact.csv")
setwd("/Users/Scott/Google Drive/Hurwitz Lab/cuffdiff_reallyall")
filtered_annotated <- read.csv("diff_exp_for_all_bact.csv")
sum_by_product_name <- read.csv("sum_by_product_name.csv")
sum_by_gene_name <- read.csv("sum_by_gene_name.csv")
all_features <- read.csv("FeatureTable.csv")
View(all_features)
unique(all_features$Genome)
all_features <- read.csv("allFeatures.csv")
mschaedleri <- read.csv("MschaedleriFeatures.csv")
rm(all_features)
View(mschaedleri)
View(filtered_annotated)
mschaedleri_exp <- merge(mschaedleri,filtered_annotated,by.x="RefSeq.Locus.Tag",by.y="tracking_id",all=F)
View(mschaedleri_exp)
View(sum_by_product_name)
View(sum_by_gene_name)
View(mschaedleri_exp)
mschaedleri_exp_vs_all_products <- merge(mschaedleri_exp,sum_by_product_name,by.x="product_name",by.y="X",all=F)
View(mschaedleri_exp_vs_all_products)
write.csv(mschaedleri_exp_vs_all_products,"mschaedleri_contribution_to_set.csv")
setwd("/Users/Scott/tophat-bacteria/scripts/R-interactive")
system(command = "./process-cuffnorm.sh")
system("./process-cuffnorm.sh")
setwd("/Users/Scott/Google Drive/Hurwitz Lab/cuffnorm-out")
simple_gene_counts <- read.table("isoforms.fpkm_table",header = T, comment.char = "", strip.white = T, sep = "\t", quote = "", colClasses = c("character","numeric","numeric","numeric","numeric"))
simple_gene_counts$sum<-rowSums(simple_gene_counts[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")])
colnames(simple_gene_counts)
colnames(simple_gene_counts)<-c("tracking_id","S1_FPM","S2_FPM","S3_FPM","S4_FPM")
simple_gene_counts$sum<-rowSums(simple_gene_counts[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")])
filtered<-simple_gene_counts[simple_gene_counts$sum!=0,]
annotation<-read.table("id_to_product.tab",header = F,sep = '\t',quote = "",as.is = T)
lowercase_annotation<-data.frame((annotation[,1]),tolower(annotation[,2]))
annotation<-lowercase_annotation
colnames(annotation)<-c("tracking_id","product_name")
gene_annotation<-read.table("id_to_gene.tab",header = F,sep = '\t',quote = "")
View(gene_annotation)
View(annotation)
colnames(gene_annotation)<-c("tracking_id","gene")
filtered_annotated<-merge(filtered,annotation,by="tracking_id")
filtered_annotated<-merge(filtered_annotated,gene_annotation,by="tracking_id",all = F)
filtered_annotated<-filtered_annotated[order(filtered_annotated$sum,decreasing = T),]
sum_by_product_name<-rowsum(filtered_annotated[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")],group = filtered_annotated$product_name)
sum_by_gene_name<-rowsum(filtered_annotated[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")],group = filtered_annotated$gene)
write.csv(sum_by_product_name,"sum_by_product_name.csv")
write.csv(sum_by_gene_name,"sum_by_gene_name.csv")
write.csv(filtered_annotated,"diff_exp_for_all_bact.csv")
lps_path<-read.table("LPS_search_list")
lps_path<-read.table("LPS_search_list",sep = "\t",comment.char = "#")
View(lps_path)
colnames(sum_by_gene_name)<-c("gene","S1_FPM","S2_FPM","S3_FPM","S4_FPM")
View(sum_by_gene_name)
sum_by_gene_name$gene<-row.names(sum_by_gene_name)
sum_by_product_name$product<-row.names(sum_by_product_name)
View(lps_path)
just_lps_products<-merge(x=sum_by_product_name,by.x="product",y=lps_path,by.y="V1",all=F)
View(just_lps_products)
lowercase_lps<-data.frame(tolower(lps_path[,1]))
lps_path<-lowercase_lps
just_lps_products<-merge(x=sum_by_product_name,by.x="product",y=lps_path,by.y="V1",all=F)
View(lps_path)
View(lowercase_lps)
colname(lps_path)<-"V1"
colnames(lps_path)<-"V1"
just_lps_products<-merge(x=sum_by_product_name,by.x="product",y=lps_path,by.y="V1",all=F)
View(just_lps_products)
just_lps_genes<-merge(x=sum_by_gene_name,by.x="gene",y=lps_path,by.y="V1",all=F)
View(lps_path)
View(sum_by_gene_name)
View(annotation)
sum_by_gene_name$gene<-tolower(row.names(sum_by_gene_name))
just_lps_genes<-merge(x=sum_by_gene_name,by.x="gene",y=lps_path,by.y="V1",all=F)
View(just_lps_genes)
plot(just_lps_genes)
plot(just_lps_genes["lpxk"])
plot(just_lps_genes["lpxk",])
just_lps_genes["lpxk",]
just_lps_genes[which(just_lps_genes$gene=="lpxk")]
just_lps_genes[which(just_lps_genes$gene=="lpxk"),]
plot(just_lps_genes[which(just_lps_genes$gene=="lpxk"),])
plot(just_lps_genes[which(just_lps_genes$gene=="lpxk"),1:4])
plot(just_lps_genes[which(just_lps_genes$gene=="lpxk"),2:5])
barplot(just_lps_genes[which(just_lps_genes$gene=="lpxk"),2:5])
barplot(height = just_lps_genes[which(just_lps_genes$gene=="lpxk"),2:5])
View(just_lps_products)
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
View(polyamines)
colnames(polyamines)<-"V1"
just_poly_products<-merge(x=sum_by_product_name,by.x="product",y=polyamines,by.y="V1",all=F)
just_poly_genes<-merge(x=sum_by_gene_name,by.x="gene",y=polyamines,by.y="V1",all=F)
View(just_poly_products)
View(polyamines)
View(just_poly_genes)
polyamines<-!duplicated(polyamines[,1])
polyamines<-duplicated(polyamines[,1])
polyamines<-polyamines[duplicated(polyamines[,1])]
polyamines[duplicated(polyamines[,1]),]
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines[duplicated(polyamines[,1]),]
polyamines[!duplicated(polyamines[,1]),]
polyamines<-polyamines[!duplicated(polyamines[,1]),]
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-polyamines[!duplicated(polyamines[,1]),]
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-polyamines[duplicated(polyamines[,1]),]
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-data.frame(polyamines[duplicated(polyamines[,1]),])
View(polyamines)
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-data.frame(V1=polyamines[duplicated(polyamines[,1]),])
polyamines<-polyamines[!duplicated(polyamines),]
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-polyamines[!duplicated(polyamines),]
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-unique(polyamines)
just_poly_products<-merge(x=sum_by_product_name,by.x="product",y=polyamines,by.y="V1",all=F)
just_poly_genes<-merge(x=sum_by_gene_name,by.x="gene",y=polyamines,by.y="V1",all=F)
View(just_poly_products)
View(just_poly_genes)
setwd("/Users/Scott/Google Drive/Hurwitz Lab/cuffnorm-out")
filtered_annotated <- read.csv("diff_exp_for_all_bact.csv")
sum_by_product_name <- read.csv("sum_by_product_name.csv")
sum_by_gene_name <- read.csv("sum_by_gene_name.csv")
#for LPS pathway####
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-unique(polyamines)
library("KEGGREST", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
library("KEGGgraph", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
library("KEGG.db", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
just_poly_products<-merge(x=sum_by_product_name,by.x="product",y=polyamines,by.y="V1",all=F)
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-unique(polyamines)
just_poly_products<-merge(x=sum_by_product_name,by.x="product",y=polyamines,by.y="V1",all=F)
View(sum_by_product_name)
View(sum_by_gene_name)
colnames(sum_by_product_name)[1]<-"product"
View(sum_by_product_name)
colnames(sum_by_gene_name)[1]<-"gene"
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-unique(polyamines)
just_poly_products<-merge(x=sum_by_product_name,by.x="product",y=polyamines,by.y="V1",all=F)
just_poly_genes<-merge(x=sum_by_gene_name,by.x="gene",y=polyamines,by.y="V1",all=F)
?keggGet
?keggFind
listDatabases()
keggFind("ko","1-pyrroline-5-carboxylate dehydrogenase")
keggFind("ko","1-pyrroline-5-carboxylate dehydrogenase")[1]
keggFind("ko","1-pyrroline-5-carboxylate dehydrogenase")[[1]]
keggFind("ko","1-pyrroline-5-carboxylate dehydrogenase")[,1]
dim(keggFind("ko","1-pyrroline-5-carboxylate dehydrogenase"))
results<-keggFind("ko","1-pyrroline-5-carboxylate dehydrogenase")
results
results[1]
results[2]
results[3]
results[1]
results[1,1]
results[1]
colnames(results[1])
results[1][1]
results[1]
results[1]->string
string
string[1]
typeof(results)
results[[1]]
description(results)
head(results)
table(results)
results
egrep('ko.*',results)
grep('ko.*',results)
setwd("/Users/Scott/Google Drive/Hurwitz Lab/cuffnorm-out")
library(KEGGgraph)
library(KEGGREST)
filtered_annotated <- read.csv("diff_exp_for_all_bact.csv")
sum_by_product_name <- read.csv("sum_by_product_name.csv")
colnames(sum_by_product_name)[1]<-"product"
sum_by_gene_name <- read.csv("sum_by_gene_name.csv")
colnames(sum_by_gene_name)[1]<-"gene"
#for LPS pathway####
lps_path<-read.table("LPS_search_list",sep = "\t",comment.char = "#")
lowercase_lps<-data.frame(tolower(lps_path[,1]))
lps_path<-lowercase_lps
colnames(lps_path)<-"V1"
just_lps_products<-merge(x=sum_by_product_name,by.x="product",y=lps_path,by.y="V1",all=F)
just_lps_genes<-merge(x=sum_by_gene_name,by.x="gene",y=lps_path,by.y="V1",all=F)
polyamines<-read.table("polyamine-search-list",sep="\t",comment.char = "#")
polyamines<-data.frame(tolower(polyamines[,1]))
colnames(polyamines)<-"V1"
polyamines<-unique(polyamines)
just_poly_products<-merge(x=sum_by_product_name,by.x="product",y=polyamines,by.y="V1",all=F)
just_poly_genes<-merge(x=sum_by_gene_name,by.x="gene",y=polyamines,by.y="V1",all=F)
mschaedleri <- read.csv("MschaedleriFeatures.csv")
mschaedleri_exp <- merge(mschaedleri,filtered_annotated,by.x="RefSeq.Locus.Tag",by.y="tracking_id",all=F)
View(filtered_annotated)
filtered_annotated <- read.csv("diff_exp_for_all_bact.csv")
View(filtered_annotated)
View(sum_by_gene_name)
simple_gene_counts <- read.table("isoforms.FPKM_table",header = T, comment.char = "", strip.white = T, sep = "\t", quote = "", colClasses = c("character","numeric","numeric","numeric","numeric"))
colnames(simple_gene_counts)<-c("tracking_id","S1_FPM","S2_FPM","S3_FPM","S4_FPM")
simple_gene_counts$sum<-rowSums(simple_gene_counts[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")])
filtered<-simple_gene_counts[simple_gene_counts$sum!=0,]
annotation<-read.table("id_to_product.tab",header = F,sep = '\t',quote = "",as.is = T)
lowercase_annotation<-data.frame((annotation[,1]),tolower(annotation[,2]))
annotation<-lowercase_annotation
colnames(annotation)<-c("tracking_id","product_name")
gene_annotation<-read.table("id_to_gene.tab",header = F,sep = '\t',quote = "")
colnames(gene_annotation)<-c("tracking_id","gene")
filtered_annotated<-merge(filtered,annotation,by="tracking_id")
filtered_annotated<-merge(filtered_annotated,gene_annotation,by="tracking_id",all = F)
filtered_annotated<-filtered_annotated[order(filtered_annotated$sum,decreasing = T),]
sum_by_product_name<-rowsum(filtered_annotated[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")],group = filtered_annotated$product_name)
sum_by_gene_name<-rowsum(filtered_annotated[,c("S1_FPM","S2_FPM","S3_FPM","S4_FPM")],group = filtered_annotated$gene)
sum_by_gene_name$gene<-tolower(row.names(sum_by_gene_name))
sum_by_product_name$product<-row.names(sum_by_product_name)
write.csv(sum_by_product_name,"sum_by_product_name.csv")
write.csv(sum_by_gene_name,"sum_by_gene_name.csv")
write.csv(filtered_annotated,"diff_exp_for_all_bact.csv")
mschaedleri <- read.csv("MschaedleriFeatures.csv")
mschaedleri_exp <- merge(mschaedleri,filtered_annotated,by.x="RefSeq.Locus.Tag",by.y="tracking_id",all=F)
mschaedleri_exp_vs_all_products <- merge(mschaedleri_exp,sum_by_product_name,by.x="product_name",by.y="X",all=F)
mschaedleri_exp_vs_all_products <- merge(mschaedleri_exp,sum_by_product_name,by.x="product_name",by.y="product",all=F)
write.csv(mschaedleri_exp_vs_all_products,"mschaedleri_contribution_to_set.csv")
View(sum_by_gene_name)
View(sum_by_product_name)
View(sum_by_gene_name)
View(sum_by_product_name)
filtered_annotated <- read.csv("diff_exp_for_all_bact.csv")
sum_by_product_name <- read.csv("sum_by_product_name.csv")
View(sum_by_product_name)
colnames(sum_by_product_name)[1]<-"product"
sum_by_gene_name <- read.csv("sum_by_gene_name.csv")
colnames(sum_by_gene_name)[1]<-"gene"
#for LPS pathway####
lps_path<-read.table("LPS_search_list",sep = "\t",comment.char = "#")
lowercase_lps<-data.frame(tolower(lps_path[,1]))
lps_path<-lowercase_lps
colnames(lps_path)<-"V1"
just_lps_products<-merge(x=sum_by_product_name,by.x="product",y=lps_path,by.y="V1",all=F)
View(sum_by_product_name)
sum_by_product_name<-sum_by_product_name[,1:5]
sum_by_gene_name<-sum_by_gene_name[,1:5]
#for LPS pathway####
lps_path<-read.table("LPS_search_list",sep = "\t",comment.char = "#")
lowercase_lps<-data.frame(tolower(lps_path[,1]))
lps_path<-lowercase_lps
colnames(lps_path)<-"V1"
just_lps_products<-merge(x=sum_by_product_name,by.x="product",y=lps_path,by.y="V1",all=F)
just_lps_genes<-merge(x=sum_by_gene_name,by.x="gene",y=lps_path,by.y="V1",all=F)
View(sum_by_product_name)
View(lowercase_lps)
View(lps_path)
View(sum_by_gene_name)
View(mschaedleri_exp_vs_all_products)
View(sum_by_gene_name)
View(lowercase_lps)
View(lps_path)
View(just_lps_genes)
